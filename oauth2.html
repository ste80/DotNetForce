<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DotNetForce OAuth2</title>
</head>
<body>
<script>
var params = {};
var paramList = location.search.replace(/^\?/, '').split('&');
for (var i = 0; i < paramList.length; i++) {
  var keyVal = paramList[i].split('=');
  params[keyVal[0]] = decodeURIComponent(keyVal[1] || '');
}
if (params.code && params.state) {
  var form = document.createElement('form');
  form.setAttribute('action', params.state + '/services/oauth2/token');
  form.setAttribute('method', 'post');
  var grant_type = document.createElement('grant_type');
  grant_type.setAttribute('type', 'hidden');
  grant_type.setAttribute('name', 'grant_type');
  grant_type.setAttribute('value', 'authorization_code');
  form.appendChild(grant_type);
  var client_id = document.createElement('client_id');
  client_id.setAttribute('type', 'hidden');
  client_id.setAttribute('name', 'client_id');
  client_id.setAttribute('value', '3MVG910YPh8zrcR3w3cOaVxURhJtcv8fxvL19jvXzqO_F819av8P2cc9VMnBOKkKTdK.uMAfUGRU_4aYDm5A3');
  form.appendChild(client_id);
  var redirect_uri = document.createElement('redirect_uri');
  redirect_uri.setAttribute('type', 'hidden');
  redirect_uri.setAttribute('name', 'redirect_uri');
  redirect_uri.setAttribute('value', 'https://ste80.github.io/DotNetForce/oauth2');
  form.appendChild(redirect_uri);
  var code = document.createElement('redirect_uri');
  code.setAttribute('type', 'hidden');
  code.setAttribute('name', 'code');
  code.setAttribute('value', 'https://ste80.github.io/DotNetForce/oauth2');
  form.appendChild(code);
  document.body.appendChild(form);
  form.submit();
} else if (opener) {
  opener.postMessage('DNF:' + location.href, '*');
}
window.close();
</script>
</body>
<html>
